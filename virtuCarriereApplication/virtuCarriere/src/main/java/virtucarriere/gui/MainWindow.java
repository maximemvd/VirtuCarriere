/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package virtucarriere.gui;

import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyEvent;
import java.io.File;
import java.net.MalformedURLException;
import java.util.ArrayList;
import java.util.LinkedList;
import java.util.List;
import java.util.Vector;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.*;
import javax.swing.filechooser.FileSystemView;
import virtucarriere.Domaine.AffichageUtil.UnitConverter;
import virtucarriere.Domaine.Carriere.Plan.*;
import virtucarriere.Domaine.Carriere.Simulation.*;
import virtucarriere.Domaine.Controller.Controller;
import virtucarriere.Domaine.Controller.Controller.*;

public class MainWindow extends JFrame {

  public Controller controller;

  public EquipementModes selectedEquipementMode;

  public VehiculeModes selectedVehicules;

  private MeasurementUnitMode currentMeasurementUnitMode = MeasurementUnitMode.METRIC;

  private ApplicationMode currentApplicationMode;

  public Point currentMousePoint;

  public Point initMousePoint = new Point();

  public int simulationSpeed = 10;

  public int intervalle = 240;

  private boolean pauseSimulation = false;

  private List<Equipement> equipementsPopup = new LinkedList<>();

  /** Creates new form MainWindow */
  public MainWindow() {
    controller = new Controller();
    controller.initObserver();
    initComponents();
    setFocusable(true);
  }

  public void setAppMode(ApplicationMode newMode) {
    this.currentApplicationMode = newMode;
  }

  public void setMode(EquipementModes newMode) {
    this.selectedEquipementMode = newMode;
  }

  public void setVehicule(VehiculeModes newMode) {
    this.selectedVehicules = newMode;
  }

  public void accelererSimulation() {
    if (simulationSpeed >= 20) {
      TextSimulation.append("\n\n La simulation ne peut pas aller plus vite");
    } else {
      simulationSpeed = simulationSpeed + 2;
      TextSimulation.append(
          "\n\n Vitesse : "
              + (int) UnitConverter.ConvertSpeedToKm(simulationSpeed, intervalle)
              + "km/h");
    }
  }

  public void ralentirSimulation() {
    if (simulationSpeed <= 2) {
      TextSimulation.append("\n\n La simulation ne peut pas aller plus lentement");
    } else {
      simulationSpeed = simulationSpeed - 2;
      TextSimulation.append(
          "\n\n Vitesse : "
              + (int) UnitConverter.ConvertSpeedToKm(simulationSpeed, intervalle)
              + "km/h");
    }
  }

  public void pauseRestartSimulation() {
    pauseSimulation = !pauseSimulation;
  }

  public enum MeasurementUnitMode {
    METRIC
  }

  public enum ApplicationMode {
    SELECT,
    SELECT_SIMUL,
    ADD_PLAN,
    ADD_ARC,
    ADD_SIMULATION,
    ADD_CHEMIN
  }

  public MeasurementUnitMode getCurrentMeasurementUnitMode() {
    return currentMeasurementUnitMode;
  }

  public void setCurrentMeasurementUnitMode(MeasurementUnitMode newMeasurementUnitMode) {
    this.currentMeasurementUnitMode = newMeasurementUnitMode;
  }

  public DrawingPanel getDrawingPanel() {
    return this.drawingPanel;
  }

  /**
   * This method is called from within the constructor to initialize the form. WARNING: Do NOT
   * modify this code. The content of this method is always regenerated by the Form Editor.
   */
  @SuppressWarnings("unchecked")
  // <editor-fold defaultstate="collapsed" desc="Generated
  // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
  private void initComponents() {

    buttonGroup1 = new javax.swing.ButtonGroup();
    mainPanel = new javax.swing.JPanel();
    mainScrollPane = new javax.swing.JScrollPane();
    drawingPanel = new virtucarriere.gui.DrawingPanel(this);
    jPanel1 = new javax.swing.JPanel();
    jTabbedPane = new javax.swing.JTabbedPane();
    jPanel2 = new javax.swing.JPanel();
    jComboBox1 = new javax.swing.JComboBox<>();
    jLabel2 = new javax.swing.JLabel();
    jLabel3 = new javax.swing.JLabel();
    jLabel4 = new javax.swing.JLabel();
    entreeButton = new javax.swing.JButton();
    jLabel5 = new javax.swing.JLabel();
    arcButton = new javax.swing.JButton();
    jLabel8 = new javax.swing.JLabel();
    textFieldCoordonneeX = new javax.swing.JTextField();
    jLabel9 = new javax.swing.JLabel();
    jLabel10 = new javax.swing.JLabel();
    textFieldCoordonneeY = new javax.swing.JTextField();
    ajoutNoeudCoordButton = new javax.swing.JButton();
    ajoutTasCoordButton = new javax.swing.JButton();
    jLabel1 = new javax.swing.JLabel();
    jTextField2 = new javax.swing.JTextField();
    jScrollPane1 = new javax.swing.JScrollPane();
    jTextArea1 = new javax.swing.JTextArea();
    jLabel7 = new javax.swing.JLabel();
    jLabel15 = new javax.swing.JLabel();
    deleteButton = new javax.swing.JButton();
    modeSelection = new javax.swing.JToggleButton();
    ajoutNoeud = new javax.swing.JToggleButton();
    jLabel19 = new javax.swing.JLabel();
    ajoutTas = new javax.swing.JToggleButton();
    comboBoxMateriaux = new javax.swing.JComboBox<>();
    ajoutNoeudCoord = new javax.swing.JButton();
    jButton2 = new javax.swing.JButton();
    jLabel13 = new javax.swing.JLabel();
    boutonChemin = new javax.swing.JButton();
    jLabel23 = new javax.swing.JLabel();
    dimensionTas = new javax.swing.JTextField();
    jLabel24 = new javax.swing.JLabel();
    modifierAngle = new javax.swing.JButton();
    angleSpinner = new javax.swing.JTextField();
    jPanel3 = new javax.swing.JPanel();
    jLabel6 = new javax.swing.JLabel();
    ajoutChargeur = new javax.swing.JToggleButton();
    jLabel11 = new javax.swing.JLabel();
    jLabel12 = new javax.swing.JLabel();
    StartSimulation = new javax.swing.JButton();
    jScrollPane2 = new javax.swing.JScrollPane();
    TextSimulation = new javax.swing.JTextArea();
    jLabel14 = new javax.swing.JLabel();
    NomClient = new javax.swing.JTextField();
    addCamion = new javax.swing.JButton();
    materiauxComboBox = new javax.swing.JComboBox<>();
    jLabel16 = new javax.swing.JLabel();
    jLabel17 = new javax.swing.JLabel();
    jLabel18 = new javax.swing.JLabel();
    quantiteSpinner = new javax.swing.JSpinner();
    selectionSimul = new javax.swing.JToggleButton();
    deleteSimul = new javax.swing.JButton();
    jLabel20 = new javax.swing.JLabel();
    xCoordSimul = new javax.swing.JTextField();
    jLabel21 = new javax.swing.JLabel();
    yCoordSimul = new javax.swing.JTextField();
    jLabel22 = new javax.swing.JLabel();
    ajoutModifChargeur = new javax.swing.JButton();
    modifierCamion = new javax.swing.JButton();
    ajoutChargeurCoord = new javax.swing.JButton();
    slowSimulation = new javax.swing.JButton();
    fasterSimulation = new javax.swing.JButton();
    pauseRestartSimulation = new javax.swing.JButton();
    jLabel25 = new javax.swing.JLabel();
    tempsAttente = new javax.swing.JSpinner();
    jButton1 = new javax.swing.JButton();
    jButton3 = new javax.swing.JButton();
    jMenuBar1 = new javax.swing.JMenuBar();
    fichierMenu = new javax.swing.JMenu();
    menuNouveauProjet = new javax.swing.JMenuItem();
    menuOuvrirProjet = new javax.swing.JMenuItem();
    menuSauvegarderProjet = new javax.swing.JMenuItem();
    menuSauvegarderSous = new javax.swing.JMenuItem();
    menuQuitter = new javax.swing.JMenuItem();
    editionMenu = new javax.swing.JMenu();
    menuUndo = new javax.swing.JMenuItem();
    menuRedo = new javax.swing.JMenuItem();
    menuCopier = new javax.swing.JMenuItem();
    menuColler = new javax.swing.JMenuItem();
    menuCouper = new javax.swing.JMenuItem();
    affichageMenu = new javax.swing.JMenu();
    menuAffichageGrille = new javax.swing.JMenuItem();
    modifierGrille = new javax.swing.JMenuItem();
    resetGrille = new javax.swing.JMenuItem();
    importerMenu = new javax.swing.JMenu();
    importImage = new javax.swing.JMenuItem();
    resetImage = new javax.swing.JMenuItem();
    fenetreMenu = new javax.swing.JMenu();

    buttonGroup1.add(selectionSimul);
    buttonGroup1.add(modeSelection);
    buttonGroup1.add(ajoutChargeur);
    buttonGroup1.add(ajoutNoeud);
    buttonGroup1.add(ajoutTas);

    setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
    addMouseWheelListener(
        new java.awt.event.MouseWheelListener() {
          public void mouseWheelMoved(java.awt.event.MouseWheelEvent evt) {
            formMouseWheelMoved(evt);
          }
        });

    mainPanel.setLayout(new java.awt.BorderLayout());

    mainScrollPane.addMouseWheelListener(
        new java.awt.event.MouseWheelListener() {
          public void mouseWheelMoved(java.awt.event.MouseWheelEvent evt) {
            mainScrollPaneMouseWheelMoved(evt);
          }
        });

    drawingPanel.setOpaque(false);
    drawingPanel.addMouseMotionListener(
        new java.awt.event.MouseMotionAdapter() {
          public void mouseDragged(java.awt.event.MouseEvent evt) {
            drawingPanelMouseDragged(evt);
          }
        });
    drawingPanel.addMouseWheelListener(
        new java.awt.event.MouseWheelListener() {
          public void mouseWheelMoved(java.awt.event.MouseWheelEvent evt) {
            drawingPanelMouseWheelMoved(evt);
          }
        });
    drawingPanel.addMouseListener(
        new java.awt.event.MouseAdapter() {
          public void mouseClicked(java.awt.event.MouseEvent evt) {
            drawingPanelMouseClicked(evt);
          }

          public void mousePressed(java.awt.event.MouseEvent evt) {
            drawingPanelMousePressed(evt);
          }

          public void mouseReleased(java.awt.event.MouseEvent evt) {
            drawingPanelMouseReleased(evt);
          }
        });
    drawingPanel.addKeyListener(
        new java.awt.event.KeyAdapter() {
          public void keyPressed(java.awt.event.KeyEvent evt) {
            drawingPanelKeyPressed(evt);
          }
        });
    drawingPanel.addMouseMotionListener(
        new java.awt.event.MouseMotionAdapter() {
          public void mouseMoved(java.awt.event.MouseEvent evt) {
            drawingPanelMouseMoved(evt);
          }
        });
    drawingPanel.setLayout(new java.awt.BorderLayout());
    mainScrollPane.setViewportView(drawingPanel);

    mainPanel.add(mainScrollPane, java.awt.BorderLayout.CENTER);

    jPanel1.setPreferredSize(new java.awt.Dimension(300, 765));

    jTabbedPane.addChangeListener(
        new javax.swing.event.ChangeListener() {
          public void stateChanged(javax.swing.event.ChangeEvent evt) {
            jTabbedPaneStateChanged(evt);
          }
        });

    jComboBox1.setModel(
        new javax.swing.DefaultComboBoxModel<>(
            new String[] {"Sélectionner", "Broyeur", "Concasseur", "Crible", "Convoyeur"}));
    jComboBox1.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            jComboBox1ActionPerformed(evt);
          }
        });

    jLabel2.setText("Ajouter un équipement");

    jLabel3.setText("Ajouter un noeud");

    jLabel4.setText("Ajouter une entrée");

    entreeButton.setText("Entrée");
    entreeButton.addMouseListener(
        new java.awt.event.MouseAdapter() {
          public void mousePressed(java.awt.event.MouseEvent evt) {
            entreeButtonMousePressed(evt);
          }
        });
    entreeButton.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            entreeButtonActionPerformed(evt);
          }
        });
    entreeButton.addKeyListener(
        new java.awt.event.KeyAdapter() {
          public void keyPressed(java.awt.event.KeyEvent evt) {
            entreeButtonKeyPressed(evt);
          }
        });

    jLabel5.setText("Ajouter un Arc");

    arcButton.setText("Arc");
    arcButton.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            arcButtonActionPerformed(evt);
          }
        });

    jLabel8.setText("Ajouter/Modifier un noeud ou tas");

    textFieldCoordonneeX.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            textFieldCoordonneeXActionPerformed(evt);
          }
        });

    jLabel9.setText("x :");

    jLabel10.setText("y :");

    ajoutNoeudCoordButton.setText("Modifier");
    ajoutNoeudCoordButton.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            ajoutNoeudCoordButtonActionPerformed(evt);
          }
        });

    ajoutTasCoordButton.setText("Modifier");
    ajoutTasCoordButton.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            ajoutTasCoordButtonActionPerformed(evt);
          }
        });

    jLabel1.setText("Élément(s) sélectionné(s) :");

    jTextField2.setText("0");
    jTextField2.setEnabled(false);

    jTextArea1.setEditable(false);
    jTextArea1.setColumns(20);
    jTextArea1.setRows(5);
    jTextArea1.addContainerListener(
        new java.awt.event.ContainerAdapter() {
          public void componentAdded(java.awt.event.ContainerEvent evt) {
            jTextArea1ComponentAdded(evt);
          }
        });
    jScrollPane1.setViewportView(jTextArea1);

    jLabel7.setText("Noeud");

    jLabel15.setText("Tas");

    deleteButton.setText("Supprimer");
    deleteButton.addMouseListener(
        new java.awt.event.MouseAdapter() {
          public void mouseClicked(java.awt.event.MouseEvent evt) {
            deleteButtonMouseClicked(evt);
          }

          public void mousePressed(java.awt.event.MouseEvent evt) {
            deleteButtonMousePressed(evt);
          }
        });
    deleteButton.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            deleteButtonActionPerformed(evt);
          }
        });
    deleteButton.addKeyListener(
        new java.awt.event.KeyAdapter() {
          public void keyPressed(java.awt.event.KeyEvent evt) {
            deleteButtonKeyPressed(evt);
          }
        });

    modeSelection.setText("Sélection");
    modeSelection.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            modeSelectionActionPerformed(evt);
          }
        });
    modeSelection.addKeyListener(
        new java.awt.event.KeyAdapter() {
          public void keyPressed(java.awt.event.KeyEvent evt) {
            modeSelectionKeyPressed(evt);
          }
        });

    ajoutNoeud.setText("Noeud");
    ajoutNoeud.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            ajoutNoeudActionPerformed(evt);
          }
        });

    jLabel19.setText("Ajouter un tas");

    ajoutTas.setText("Tas");
    ajoutTas.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            ajoutTasActionPerformed(evt);
          }
        });

    comboBoxMateriaux.setModel(
        new javax.swing.DefaultComboBoxModel<>(
            new String[] {"1-110", "1-214", "1-220", "1-228", "1-644", "1-630", "1-695"}));

    ajoutNoeudCoord.setText("Ajouter");
    ajoutNoeudCoord.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            ajoutNoeudCoordActionPerformed(evt);
          }
        });

    jButton2.setText("Ajouter");
    jButton2.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            jButton2ActionPerformed(evt);
          }
        });

    jLabel13.setText("Tracer un chemin");

    boutonChemin.setText("Chemin");
    boutonChemin.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            boutonCheminActionPerformed(evt);
          }
        });

    jLabel23.setText("Modifier rayon du Tas");

    dimensionTas.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            dimensionTasActionPerformed(evt);
          }
        });

    jLabel24.setText("Angle :");

    modifierAngle.setText("Modifier");
    modifierAngle.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            modifierAngleActionPerformed(evt);
          }
        });

    angleSpinner.setText("0");

    javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
    jPanel2.setLayout(jPanel2Layout);
    jPanel2Layout.setHorizontalGroup(
        jPanel2Layout
            .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane1, javax.swing.GroupLayout.Alignment.TRAILING)
            .addGroup(
                jPanel2Layout
                    .createSequentialGroup()
                    .addGroup(
                        jPanel2Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(
                                jPanel2Layout
                                    .createSequentialGroup()
                                    .addComponent(jLabel1)
                                    .addPreferredGap(
                                        javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(
                                        jTextField2,
                                        javax.swing.GroupLayout.PREFERRED_SIZE,
                                        39,
                                        javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(
                                jPanel2Layout
                                    .createSequentialGroup()
                                    .addContainerGap()
                                    .addComponent(jLabel8)))
                    .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addGroup(
                jPanel2Layout
                    .createSequentialGroup()
                    .addContainerGap()
                    .addGroup(
                        jPanel2Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(
                                javax.swing.GroupLayout.Alignment.TRAILING,
                                jPanel2Layout
                                    .createSequentialGroup()
                                    .addGap(0, 23, Short.MAX_VALUE)
                                    .addGroup(
                                        jPanel2Layout
                                            .createParallelGroup(
                                                javax.swing.GroupLayout.Alignment.LEADING)
                                            .addGroup(
                                                javax.swing.GroupLayout.Alignment.TRAILING,
                                                jPanel2Layout
                                                    .createSequentialGroup()
                                                    .addComponent(
                                                        jComboBox1,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE,
                                                        javax.swing.GroupLayout.DEFAULT_SIZE,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE)
                                                    .addGap(64, 64, 64))
                                            .addGroup(
                                                javax.swing.GroupLayout.Alignment.TRAILING,
                                                jPanel2Layout
                                                    .createSequentialGroup()
                                                    .addGroup(
                                                        jPanel2Layout
                                                            .createParallelGroup(
                                                                javax.swing.GroupLayout.Alignment
                                                                    .LEADING,
                                                                false)
                                                            .addComponent(
                                                                ajoutNoeudCoord,
                                                                javax.swing.GroupLayout
                                                                    .DEFAULT_SIZE,
                                                                javax.swing.GroupLayout
                                                                    .DEFAULT_SIZE,
                                                                Short.MAX_VALUE)
                                                            .addComponent(
                                                                ajoutNoeudCoordButton,
                                                                javax.swing.GroupLayout
                                                                    .PREFERRED_SIZE,
                                                                1,
                                                                Short.MAX_VALUE))
                                                    .addGap(30, 30, 30)
                                                    .addGroup(
                                                        jPanel2Layout
                                                            .createParallelGroup(
                                                                javax.swing.GroupLayout.Alignment
                                                                    .LEADING)
                                                            .addComponent(ajoutTasCoordButton)
                                                            .addComponent(jButton2)
                                                            .addGroup(
                                                                jPanel2Layout
                                                                    .createSequentialGroup()
                                                                    .addGap(6, 6, 6)
                                                                    .addComponent(modifierAngle)))
                                                    .addGap(24, 24, 24))
                                            .addGroup(
                                                javax.swing.GroupLayout.Alignment.TRAILING,
                                                jPanel2Layout
                                                    .createSequentialGroup()
                                                    .addComponent(
                                                        modeSelection,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE,
                                                        110,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE)
                                                    .addGap(18, 18, 18)
                                                    .addComponent(deleteButton)
                                                    .addGap(15, 15, 15))))
                            .addGroup(
                                jPanel2Layout
                                    .createSequentialGroup()
                                    .addGroup(
                                        jPanel2Layout
                                            .createParallelGroup(
                                                javax.swing.GroupLayout.Alignment.LEADING)
                                            .addGroup(
                                                jPanel2Layout
                                                    .createParallelGroup(
                                                        javax.swing.GroupLayout.Alignment.TRAILING)
                                                    .addGroup(
                                                        jPanel2Layout
                                                            .createParallelGroup(
                                                                javax.swing.GroupLayout.Alignment
                                                                    .LEADING)
                                                            .addComponent(jLabel3)
                                                            .addGroup(
                                                                jPanel2Layout
                                                                    .createSequentialGroup()
                                                                    .addGap(92, 92, 92)
                                                                    .addComponent(ajoutNoeud))
                                                            .addGroup(
                                                                jPanel2Layout
                                                                    .createSequentialGroup()
                                                                    .addGap(52, 52, 52)
                                                                    .addComponent(ajoutTas)
                                                                    .addPreferredGap(
                                                                        javax.swing.LayoutStyle
                                                                            .ComponentPlacement
                                                                            .RELATED)
                                                                    .addComponent(
                                                                        comboBoxMateriaux,
                                                                        javax.swing.GroupLayout
                                                                            .PREFERRED_SIZE,
                                                                        javax.swing.GroupLayout
                                                                            .DEFAULT_SIZE,
                                                                        javax.swing.GroupLayout
                                                                            .PREFERRED_SIZE))
                                                            .addComponent(jLabel19))
                                                    .addGroup(
                                                        jPanel2Layout
                                                            .createSequentialGroup()
                                                            .addGroup(
                                                                jPanel2Layout
                                                                    .createParallelGroup(
                                                                        javax.swing.GroupLayout
                                                                            .Alignment.LEADING)
                                                                    .addGroup(
                                                                        jPanel2Layout
                                                                            .createSequentialGroup()
                                                                            .addComponent(jLabel9)
                                                                            .addPreferredGap(
                                                                                javax.swing
                                                                                    .LayoutStyle
                                                                                    .ComponentPlacement
                                                                                    .UNRELATED)
                                                                            .addComponent(
                                                                                textFieldCoordonneeX,
                                                                                javax.swing
                                                                                    .GroupLayout
                                                                                    .PREFERRED_SIZE,
                                                                                49,
                                                                                javax.swing
                                                                                    .GroupLayout
                                                                                    .PREFERRED_SIZE)
                                                                            .addGap(18, 18, 18)
                                                                            .addComponent(jLabel10))
                                                                    .addComponent(jLabel7))
                                                            .addPreferredGap(
                                                                javax.swing.LayoutStyle
                                                                    .ComponentPlacement.UNRELATED)
                                                            .addGroup(
                                                                jPanel2Layout
                                                                    .createParallelGroup(
                                                                        javax.swing.GroupLayout
                                                                            .Alignment.LEADING)
                                                                    .addComponent(
                                                                        textFieldCoordonneeY,
                                                                        javax.swing.GroupLayout
                                                                            .PREFERRED_SIZE,
                                                                        48,
                                                                        javax.swing.GroupLayout
                                                                            .PREFERRED_SIZE)
                                                                    .addComponent(jLabel15))
                                                            .addGap(6, 6, 6)))
                                            .addComponent(jLabel2)
                                            .addGroup(
                                                jPanel2Layout
                                                    .createSequentialGroup()
                                                    .addComponent(jLabel24)
                                                    .addGap(18, 18, 18)
                                                    .addComponent(
                                                        angleSpinner,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE,
                                                        82,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE))
                                            .addGroup(
                                                jPanel2Layout
                                                    .createParallelGroup(
                                                        javax.swing.GroupLayout.Alignment.TRAILING,
                                                        false)
                                                    .addGroup(
                                                        jPanel2Layout
                                                            .createSequentialGroup()
                                                            .addComponent(jLabel4)
                                                            .addPreferredGap(
                                                                javax.swing.LayoutStyle
                                                                    .ComponentPlacement.RELATED)
                                                            .addComponent(
                                                                entreeButton,
                                                                javax.swing.GroupLayout
                                                                    .DEFAULT_SIZE,
                                                                javax.swing.GroupLayout
                                                                    .DEFAULT_SIZE,
                                                                Short.MAX_VALUE))
                                                    .addGroup(
                                                        javax.swing.GroupLayout.Alignment.LEADING,
                                                        jPanel2Layout
                                                            .createSequentialGroup()
                                                            .addGroup(
                                                                jPanel2Layout
                                                                    .createParallelGroup(
                                                                        javax.swing.GroupLayout
                                                                            .Alignment.LEADING)
                                                                    .addComponent(jLabel13)
                                                                    .addComponent(jLabel5))
                                                            .addGap(18, 18, 18)
                                                            .addGroup(
                                                                jPanel2Layout
                                                                    .createParallelGroup(
                                                                        javax.swing.GroupLayout
                                                                            .Alignment.LEADING,
                                                                        false)
                                                                    .addComponent(
                                                                        boutonChemin,
                                                                        javax.swing.GroupLayout
                                                                            .DEFAULT_SIZE,
                                                                        javax.swing.GroupLayout
                                                                            .DEFAULT_SIZE,
                                                                        Short.MAX_VALUE)
                                                                    .addComponent(
                                                                        arcButton,
                                                                        javax.swing.GroupLayout
                                                                            .DEFAULT_SIZE,
                                                                        javax.swing.GroupLayout
                                                                            .DEFAULT_SIZE,
                                                                        Short.MAX_VALUE))))
                                            .addGroup(
                                                jPanel2Layout
                                                    .createSequentialGroup()
                                                    .addComponent(jLabel23)
                                                    .addPreferredGap(
                                                        javax.swing.LayoutStyle.ComponentPlacement
                                                            .RELATED)
                                                    .addComponent(
                                                        dimensionTas,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE,
                                                        43,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE)))
                                    .addGap(0, 0, Short.MAX_VALUE)))));
    jPanel2Layout.setVerticalGroup(
        jPanel2Layout
            .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(
                jPanel2Layout
                    .createSequentialGroup()
                    .addContainerGap()
                    .addGroup(
                        jPanel2Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(modeSelection)
                            .addComponent(deleteButton))
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                    .addComponent(jLabel2)
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addComponent(
                        jComboBox1,
                        javax.swing.GroupLayout.PREFERRED_SIZE,
                        javax.swing.GroupLayout.DEFAULT_SIZE,
                        javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addComponent(jLabel3)
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addComponent(ajoutNoeud)
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addComponent(jLabel19)
                    .addGap(2, 2, 2)
                    .addGroup(
                        jPanel2Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(ajoutTas)
                            .addComponent(
                                comboBoxMateriaux,
                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addGroup(
                        jPanel2Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel23)
                            .addComponent(
                                dimensionTas,
                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGap(7, 7, 7)
                    .addComponent(jLabel8)
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                    .addGroup(
                        jPanel2Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel9)
                            .addGroup(
                                jPanel2Layout
                                    .createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                    .addComponent(jLabel10)
                                    .addComponent(
                                        textFieldCoordonneeY,
                                        javax.swing.GroupLayout.PREFERRED_SIZE,
                                        javax.swing.GroupLayout.DEFAULT_SIZE,
                                        javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(
                                        textFieldCoordonneeX,
                                        javax.swing.GroupLayout.PREFERRED_SIZE,
                                        javax.swing.GroupLayout.DEFAULT_SIZE,
                                        javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                    .addGroup(
                        jPanel2Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(
                                jPanel2Layout
                                    .createSequentialGroup()
                                    .addComponent(jLabel7)
                                    .addPreferredGap(
                                        javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addGroup(
                                        jPanel2Layout
                                            .createParallelGroup(
                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                            .addComponent(ajoutNoeudCoord)
                                            .addComponent(jButton2))
                                    .addPreferredGap(
                                        javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addGroup(
                                        jPanel2Layout
                                            .createParallelGroup(
                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                            .addComponent(ajoutNoeudCoordButton)
                                            .addComponent(ajoutTasCoordButton))
                                    .addPreferredGap(
                                        javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addGroup(
                                        jPanel2Layout
                                            .createParallelGroup(
                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                            .addComponent(jLabel24)
                                            .addComponent(modifierAngle)
                                            .addComponent(
                                                angleSpinner,
                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                    .addGap(10, 10, 10)
                                    .addGroup(
                                        jPanel2Layout
                                            .createParallelGroup(
                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                            .addComponent(arcButton)
                                            .addComponent(jLabel5))
                                    .addPreferredGap(
                                        javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                    .addGroup(
                                        jPanel2Layout
                                            .createParallelGroup(
                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                            .addComponent(jLabel13)
                                            .addComponent(boutonChemin))
                                    .addGap(6, 6, 6)
                                    .addGroup(
                                        jPanel2Layout
                                            .createParallelGroup(
                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                            .addComponent(jLabel4)
                                            .addComponent(entreeButton))
                                    .addPreferredGap(
                                        javax.swing.LayoutStyle.ComponentPlacement.RELATED,
                                        javax.swing.GroupLayout.DEFAULT_SIZE,
                                        Short.MAX_VALUE)
                                    .addGroup(
                                        jPanel2Layout
                                            .createParallelGroup(
                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                            .addComponent(jLabel1)
                                            .addComponent(
                                                jTextField2,
                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                    .addPreferredGap(
                                        javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(
                                        jScrollPane1,
                                        javax.swing.GroupLayout.PREFERRED_SIZE,
                                        310,
                                        javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(
                                jPanel2Layout
                                    .createSequentialGroup()
                                    .addComponent(jLabel15)
                                    .addGap(0, 0, Short.MAX_VALUE)))));

    jTabbedPane.addTab("Plan", jPanel2);

    jLabel6.setFont(new java.awt.Font("Lucida Grande", 1, 18)); // NOI18N
    jLabel6.setText("Scénario");

    ajoutChargeur.setText("Chargeur");
    ajoutChargeur.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            ajoutChargeurActionPerformed(evt);
          }
        });

    jLabel11.setText("Ajouter un véhicule de chargement");

    jLabel12.setFont(new java.awt.Font("Lucida Grande", 1, 14)); // NOI18N
    jLabel12.setText("Ajouter un client (camion)");

    StartSimulation.setFont(new java.awt.Font("Lucida Grande", 0, 15)); // NOI18N
    StartSimulation.setText("Play");
    StartSimulation.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            StartSimulationActionPerformed(evt);
          }
        });

    TextSimulation.setEditable(false);
    TextSimulation.setColumns(20);
    TextSimulation.setRows(5);
    jScrollPane2.setViewportView(TextSimulation);

    jLabel14.setText("Informations");

    NomClient.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            NomClientActionPerformed(evt);
          }
        });

    addCamion.setText("Ajouter");
    addCamion.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            addCamionActionPerformed(evt);
          }
        });

    materiauxComboBox.setModel(
        new javax.swing.DefaultComboBoxModel<>(
            new String[] {"1-110", "1-214", "1-220", "1-228", "1-644", "1-630", "1-695"}));

    jLabel16.setText("Nom :");

    jLabel17.setText("Matériaux :");

    jLabel18.setText("Quantité :");

    selectionSimul.setText("Sélectionner");
    selectionSimul.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            selectionSimulActionPerformed(evt);
          }
        });

    deleteSimul.setText("Supprimer");
    deleteSimul.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            deleteSimulActionPerformed(evt);
          }
        });

    jLabel20.setText("x :");

    jLabel21.setText("Ajouter chargeur/Modifier emplacement");

    jLabel22.setText("y :");

    ajoutModifChargeur.setText("Modifier");
    ajoutModifChargeur.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            ajoutModifChargeurActionPerformed(evt);
          }
        });

    modifierCamion.setText("Modifier");
    modifierCamion.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            modifierCamionActionPerformed(evt);
          }
        });

    ajoutChargeurCoord.setText("Ajouter");
    ajoutChargeurCoord.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            ajoutChargeurCoordActionPerformed(evt);
          }
        });

    slowSimulation.setText("Slower");
    slowSimulation.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            slowSimulationActionPerformed(evt);
          }
        });

    fasterSimulation.setText("Faster");
    fasterSimulation.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            fasterSimulationActionPerformed(evt);
          }
        });

    pauseRestartSimulation.setText("Pause");
    pauseRestartSimulation.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            pauseRestartSimulationActionPerformed(evt);
          }
        });

    jLabel25.setText("Temps d'attente :");

    jButton1.setText("Save");
    jButton1.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            jButton1ActionPerformed(evt);
          }
        });

    jButton3.setText("Importer");
    jButton3.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            jButton3ActionPerformed(evt);
          }
        });

    javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
    jPanel3.setLayout(jPanel3Layout);
    jPanel3Layout.setHorizontalGroup(
        jPanel3Layout
            .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(
                jPanel3Layout
                    .createSequentialGroup()
                    .addGroup(
                        jPanel3Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(
                                jPanel3Layout
                                    .createSequentialGroup()
                                    .addGap(87, 87, 87)
                                    .addComponent(ajoutChargeur))
                            .addGroup(
                                jPanel3Layout
                                    .createSequentialGroup()
                                    .addGap(20, 20, 20)
                                    .addComponent(selectionSimul)
                                    .addPreferredGap(
                                        javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(deleteSimul))
                            .addGroup(
                                jPanel3Layout
                                    .createSequentialGroup()
                                    .addContainerGap()
                                    .addGroup(
                                        jPanel3Layout
                                            .createParallelGroup(
                                                javax.swing.GroupLayout.Alignment.TRAILING, false)
                                            .addGroup(
                                                javax.swing.GroupLayout.Alignment.LEADING,
                                                jPanel3Layout
                                                    .createSequentialGroup()
                                                    .addComponent(jLabel16)
                                                    .addPreferredGap(
                                                        javax.swing.LayoutStyle.ComponentPlacement
                                                            .RELATED,
                                                        javax.swing.GroupLayout.DEFAULT_SIZE,
                                                        Short.MAX_VALUE)
                                                    .addComponent(
                                                        NomClient,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE,
                                                        153,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE))
                                            .addGroup(
                                                javax.swing.GroupLayout.Alignment.LEADING,
                                                jPanel3Layout
                                                    .createSequentialGroup()
                                                    .addComponent(jLabel17)
                                                    .addPreferredGap(
                                                        javax.swing.LayoutStyle.ComponentPlacement
                                                            .RELATED)
                                                    .addComponent(
                                                        materiauxComboBox,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE,
                                                        153,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE))))
                            .addGroup(
                                jPanel3Layout
                                    .createSequentialGroup()
                                    .addContainerGap()
                                    .addComponent(jLabel21))
                            .addComponent(
                                jScrollPane2,
                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                289,
                                javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(
                                jPanel3Layout
                                    .createSequentialGroup()
                                    .addContainerGap()
                                    .addGroup(
                                        jPanel3Layout
                                            .createParallelGroup(
                                                javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(jLabel12)
                                            .addComponent(jLabel11)))
                            .addGroup(
                                jPanel3Layout
                                    .createSequentialGroup()
                                    .addContainerGap()
                                    .addGroup(
                                        jPanel3Layout
                                            .createParallelGroup(
                                                javax.swing.GroupLayout.Alignment.LEADING)
                                            .addGroup(
                                                jPanel3Layout
                                                    .createSequentialGroup()
                                                    .addComponent(jLabel25)
                                                    .addPreferredGap(
                                                        javax.swing.LayoutStyle.ComponentPlacement
                                                            .RELATED)
                                                    .addComponent(
                                                        tempsAttente,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE,
                                                        72,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE))
                                            .addGroup(
                                                jPanel3Layout
                                                    .createSequentialGroup()
                                                    .addComponent(jLabel18)
                                                    .addPreferredGap(
                                                        javax.swing.LayoutStyle.ComponentPlacement
                                                            .UNRELATED)
                                                    .addComponent(
                                                        quantiteSpinner,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE,
                                                        72,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE)))))
                    .addGap(0, 0, Short.MAX_VALUE))
            .addGroup(
                jPanel3Layout
                    .createSequentialGroup()
                    .addGroup(
                        jPanel3Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(
                                jPanel3Layout
                                    .createSequentialGroup()
                                    .addGap(11, 11, 11)
                                    .addGroup(
                                        jPanel3Layout
                                            .createParallelGroup(
                                                javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(jLabel14)
                                            .addGroup(
                                                jPanel3Layout
                                                    .createSequentialGroup()
                                                    .addComponent(
                                                        slowSimulation,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE,
                                                        66,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE)
                                                    .addPreferredGap(
                                                        javax.swing.LayoutStyle.ComponentPlacement
                                                            .RELATED)
                                                    .addComponent(
                                                        StartSimulation,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE,
                                                        60,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE)
                                                    .addPreferredGap(
                                                        javax.swing.LayoutStyle.ComponentPlacement
                                                            .RELATED)
                                                    .addComponent(
                                                        pauseRestartSimulation,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE,
                                                        58,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE)
                                                    .addPreferredGap(
                                                        javax.swing.LayoutStyle.ComponentPlacement
                                                            .RELATED)
                                                    .addComponent(
                                                        fasterSimulation,
                                                        javax.swing.GroupLayout.PREFERRED_SIZE,
                                                        62,
                                                        Short.MAX_VALUE))))
                            .addGroup(
                                jPanel3Layout
                                    .createSequentialGroup()
                                    .addGap(43, 43, 43)
                                    .addGroup(
                                        jPanel3Layout
                                            .createParallelGroup(
                                                javax.swing.GroupLayout.Alignment.LEADING, false)
                                            .addComponent(
                                                addCamion,
                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                Short.MAX_VALUE)
                                            .addComponent(
                                                jButton1,
                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                Short.MAX_VALUE))
                                    .addPreferredGap(
                                        javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                    .addGroup(
                                        jPanel3Layout
                                            .createParallelGroup(
                                                javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(jButton3)
                                            .addComponent(modifierCamion))))
                    .addGap(19, 19, 19))
            .addGroup(
                javax.swing.GroupLayout.Alignment.TRAILING,
                jPanel3Layout
                    .createSequentialGroup()
                    .addContainerGap(96, Short.MAX_VALUE)
                    .addGroup(
                        jPanel3Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jLabel20)
                            .addComponent(jLabel22))
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addGroup(
                        jPanel3Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(
                                xCoordSimul,
                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                52,
                                Short.MAX_VALUE)
                            .addComponent(yCoordSimul))
                    .addGap(29, 29, 29)
                    .addGroup(
                        jPanel3Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(
                                ajoutChargeurCoord,
                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                Short.MAX_VALUE)
                            .addComponent(
                                ajoutModifChargeur,
                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                1,
                                Short.MAX_VALUE))
                    .addGap(36, 36, 36))
            .addGroup(
                jPanel3Layout
                    .createSequentialGroup()
                    .addGap(105, 105, 105)
                    .addComponent(jLabel6)
                    .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)));
    jPanel3Layout.setVerticalGroup(
        jPanel3Layout
            .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(
                jPanel3Layout
                    .createSequentialGroup()
                    .addContainerGap()
                    .addGroup(
                        jPanel3Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(selectionSimul)
                            .addComponent(deleteSimul))
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                    .addComponent(jLabel11)
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addComponent(ajoutChargeur)
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                    .addComponent(jLabel21)
                    .addGap(8, 8, 8)
                    .addGroup(
                        jPanel3Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(
                                xCoordSimul,
                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel20)
                            .addComponent(ajoutChargeurCoord))
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addGroup(
                        jPanel3Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(
                                jPanel3Layout
                                    .createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                    .addComponent(
                                        yCoordSimul,
                                        javax.swing.GroupLayout.PREFERRED_SIZE,
                                        javax.swing.GroupLayout.DEFAULT_SIZE,
                                        javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(ajoutModifChargeur))
                            .addComponent(jLabel22))
                    .addGap(54, 54, 54)
                    .addComponent(jLabel12)
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addGroup(
                        jPanel3Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel16)
                            .addComponent(
                                NomClient,
                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addGroup(
                        jPanel3Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel17)
                            .addComponent(
                                materiauxComboBox,
                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                    .addGroup(
                        jPanel3Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel18)
                            .addComponent(
                                quantiteSpinner,
                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addGroup(
                        jPanel3Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(
                                tempsAttente,
                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(
                                jLabel25,
                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                56,
                                javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addPreferredGap(
                        javax.swing.LayoutStyle.ComponentPlacement.RELATED,
                        javax.swing.GroupLayout.DEFAULT_SIZE,
                        Short.MAX_VALUE)
                    .addGroup(
                        jPanel3Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(addCamion)
                            .addComponent(modifierCamion))
                    .addGap(18, 18, 18)
                    .addGroup(
                        jPanel3Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jButton1)
                            .addComponent(jButton3))
                    .addGap(4, 4, 4)
                    .addComponent(jLabel6)
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addGroup(
                        jPanel3Layout
                            .createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(
                                StartSimulation,
                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                38,
                                javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(
                                slowSimulation,
                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                40,
                                javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(
                                fasterSimulation,
                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                39,
                                javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(
                                pauseRestartSimulation,
                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                40,
                                javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addComponent(jLabel14)
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addComponent(
                        jScrollPane2,
                        javax.swing.GroupLayout.PREFERRED_SIZE,
                        292,
                        javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGap(12, 12, 12)));

    jTabbedPane.addTab("Simulation", jPanel3);

    javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
    jPanel1.setLayout(jPanel1Layout);
    jPanel1Layout.setHorizontalGroup(
        jPanel1Layout
            .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(
                jPanel1Layout
                    .createSequentialGroup()
                    .addComponent(
                        jTabbedPane,
                        javax.swing.GroupLayout.PREFERRED_SIZE,
                        301,
                        javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGap(0, 0, Short.MAX_VALUE)));
    jPanel1Layout.setVerticalGroup(
        jPanel1Layout
            .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jTabbedPane));

    mainPanel.add(jPanel1, java.awt.BorderLayout.EAST);

    fichierMenu.setText("Fichier");

    menuNouveauProjet.setText("Nouveau projet");
    menuNouveauProjet.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            menuNouveauProjetActionPerformed(evt);
          }
        });
    fichierMenu.add(menuNouveauProjet);

    menuOuvrirProjet.setText("Ouvrir un projet");
    menuOuvrirProjet.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            menuOuvrirProjetActionPerformed(evt);
          }
        });
    fichierMenu.add(menuOuvrirProjet);

    menuSauvegarderProjet.setText("Sauvegarder");
    menuSauvegarderProjet.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            menuSauvegarderProjetActionPerformed(evt);
          }
        });
    fichierMenu.add(menuSauvegarderProjet);

    menuSauvegarderSous.setText("Sauvegarder sous...");
    menuSauvegarderSous.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            menuSauvegarderSousActionPerformed(evt);
          }
        });
    fichierMenu.add(menuSauvegarderSous);

    menuQuitter.setText("Quitter");
    menuQuitter.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            menuQuitterActionPerformed(evt);
          }
        });
    fichierMenu.add(menuQuitter);

    jMenuBar1.add(fichierMenu);

    editionMenu.setText("Édition");

    menuUndo.setText("Undo");
    menuUndo.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            menuUndoActionPerformed(evt);
          }
        });
    editionMenu.add(menuUndo);

    menuRedo.setText("Redo");
    menuRedo.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            menuRedoActionPerformed(evt);
          }
        });
    editionMenu.add(menuRedo);

    menuCopier.setText("Copier");
    editionMenu.add(menuCopier);

    menuColler.setText("Coller");
    editionMenu.add(menuColler);

    menuCouper.setText("Couper");
    editionMenu.add(menuCouper);

    jMenuBar1.add(editionMenu);

    affichageMenu.setText("Affichage");

    menuAffichageGrille.setText("Afficher/cacher la grille");
    menuAffichageGrille.setSelected(drawingPanel.getGridlines());
    menuAffichageGrille.addMouseListener(
        new java.awt.event.MouseAdapter() {
          public void mouseClicked(java.awt.event.MouseEvent evt) {
            menuAffichageGrilleMouseClicked(evt);
          }
        });
    menuAffichageGrille.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            menuAffichageGrilleActionPerformed(evt);
          }
        });
    affichageMenu.add(menuAffichageGrille);

    modifierGrille.setText("Modifier la grille");
    modifierGrille.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            modifierGrilleActionPerformed(evt);
          }
        });
    affichageMenu.add(modifierGrille);

    resetGrille.setText("Réinitialiser la grille");
    resetGrille.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            resetGrilleActionPerformed(evt);
          }
        });
    affichageMenu.add(resetGrille);

    jMenuBar1.add(affichageMenu);

    importerMenu.setText("Importer");
    importerMenu.setToolTipText("");

    importImage.setText("Importer image");
    importImage.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            importImageActionPerformed(evt);
          }
        });
    importerMenu.add(importImage);

    resetImage.setText("Réinitialiser image");
    resetImage.addActionListener(
        new java.awt.event.ActionListener() {
          public void actionPerformed(java.awt.event.ActionEvent evt) {
            resetImageActionPerformed(evt);
          }
        });
    importerMenu.add(resetImage);

    jMenuBar1.add(importerMenu);

    fenetreMenu.setText("Fenêtre");
    jMenuBar1.add(fenetreMenu);

    setJMenuBar(jMenuBar1);

    javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
    getContentPane().setLayout(layout);
    layout.setHorizontalGroup(
        layout
            .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(mainPanel, javax.swing.GroupLayout.DEFAULT_SIZE, 1524, Short.MAX_VALUE));
    layout.setVerticalGroup(
        layout
            .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(
                mainPanel,
                javax.swing.GroupLayout.DEFAULT_SIZE,
                javax.swing.GroupLayout.DEFAULT_SIZE,
                Short.MAX_VALUE));

    pack();
  } // </editor-fold>//GEN-END:initComponents

  private void jButton1ActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_jButton1ActionPerformed
    // TODO add your handling code here:
    this.controller.saveSimulation();
  } // GEN-LAST:event_jButton1ActionPerformed

  private void jButton3ActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_jButton3ActionPerformed
    // TODO add your handling code here:
    this.controller.openSimulation();
    drawingPanel.repaint();
  } // GEN-LAST:event_jButton3ActionPerformed

  private void menuUndoActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_menuUndoActionPerformed
    // TODO add your handling code here:
    this.controller.undo();
    drawingPanel.repaint();
  } // GEN-LAST:event_menuUndoActionPerformed

  private void menuRedoActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_menuRedoActionPerformed
    // TODO add your handling code here:
    this.controller.redo();
    drawingPanel.repaint();
  }

  private void modifierAngleActionPerformed(
      ActionEvent evt) { // GEN-FIRST:event_modifierAngleActionPerformed
    List<Equipement> equipements = controller.getEquipementList();

    double angle = Double.parseDouble(angleSpinner.getText());

    for (Equipement equipement : equipements) {
      if (equipement.isSelected()) {
        equipement.setAngle(angle);
      }
    }
    drawingPanel.repaint();
    rafraichissementTextField();
  } // GEN-LAST:event_modifierAngleActionPerformed

  private void pauseRestartSimulationActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_pauseRestartSimulationActionPerformed
    // TODO add your handling code here:
    pauseRestartSimulation();
  } // GEN-LAST:event_pauseRestartSimulationActionPerformed

  private void slowSimulationActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_slowSimulationActionPerformed
    // TODO add your handling code here:
    ralentirSimulation();
  } // GEN-LAST:event_slowSimulationActionPerformed

  private void fasterSimulationActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_fasterSimulationActionPerformed
    // TODO add your handling code here:
    accelererSimulation();
  } // GEN-LAST:event_fasterSimulationActionPerformed

  private void resetImageActionPerformed(java.awt.event.ActionEvent evt) {
    controller.setUrlBackground(null);
    drawingPanel.repaint();
  }

  private void importImageActionPerformed(java.awt.event.ActionEvent evt) {

    JFileChooser chooser = new JFileChooser(FileSystemView.getFileSystemView().getHomeDirectory());
    chooser.setDialogTitle("Open");
    int returnValue = chooser.showDialog(null, "Open");

    if (returnValue == JFileChooser.APPROVE_OPTION) {
      File selectedFile = chooser.getSelectedFile();

      JPanel fields = new JPanel(new GridLayout(2, 2));

      JTextField textFieldLargeur = new JTextField();
      textFieldLargeur.setPreferredSize(new Dimension(11, 15));

      JTextField textFieldlongueur = new JTextField();
      textFieldlongueur.setPreferredSize(new Dimension(11, 15));

      JLabel labellongueur = new JLabel("La longueur de l'image");
      JLabel labellargeur = new JLabel("La largeur de l'image");

      fields.add(labellargeur);
      fields.add(textFieldLargeur);
      fields.add(labellongueur);
      fields.add(textFieldlongueur);

      int result =
          JOptionPane.showConfirmDialog(
              null,
              fields,
              "Dimension de l'image",
              JOptionPane.OK_CANCEL_OPTION,
              JOptionPane.QUESTION_MESSAGE);

      if (result == JOptionPane.OK_OPTION) {
        int pictureLongueur;
        int pictureLargeur;
        try {
          pictureLargeur = Integer.parseInt(textFieldLargeur.getText());
          pictureLongueur = Integer.parseInt(textFieldlongueur.getText());
        } catch (Exception exc) {
          JOptionPane.showMessageDialog(null, "La valeur entrée n'est pas un chiffre valide");
          return;
        }
        if (pictureLongueur <= 0 && pictureLargeur <= 0) {
          JOptionPane.showMessageDialog(null, "La valeur entrée doit être plus grande que zéro");
          throw new ArithmeticException("Dimension ne peut pas etre negative");
        }
        try {
          UnitConverter.setLargeurImage(pictureLargeur);
          UnitConverter.setLongueurImage(pictureLongueur);
          controller.setUrlBackground(selectedFile.toURI().toURL());
        } catch (MalformedURLException ex) {
          Logger.getLogger(MainWindow.class.getName()).log(Level.SEVERE, null, ex);
        }
      }
      drawingPanel.repaint();
    }
  }

  private void drawingPanelMouseReleased(java.awt.event.MouseEvent evt) {
    List<Equipement> equipements = controller.getEquipementList();
    Point point = evt.getPoint();
    JPopupMenu popup = new JPopupMenu("Ajouter un équipement correspondant");
    popup.add(ajoutBroyeurPopup);
    popup.add(ajoutCriblePopup);
    popup.add(ajoutConcasseurPopup);
    for (Equipement equipement : equipements) {
      if (equipement.contains(point.getX(), point.getY())) {
        if (SwingUtilities.isRightMouseButton(evt)) {
          switch (equipement.getName()) {
            case "Concasseur":
              ajoutCriblePopup.setEnabled(false);
              ajoutConcasseurPopup.setEnabled(false);
              equipementsPopup.add(equipement);
              controller.addConvoyeur(point, EquipementModes.CONVOYEUR, 0);
              break;
            case "Broyeur":
              ajoutBroyeurPopup.setEnabled(false);
              equipementsPopup.add(equipement);
              controller.addConvoyeur(point, EquipementModes.CONVOYEUR, 0);
              break;
            case "Crible":
              ajoutConcasseurPopup.setEnabled(false);
              ajoutCriblePopup.setEnabled(false);
              equipementsPopup.add(equipement);
              controller.addConvoyeur(point, EquipementModes.CONVOYEUR, 0);
              break;
          }
          popup.show(evt.getComponent(), evt.getX(), evt.getY());
          drawingPanel.repaint();
        }
      }
    }
  }

  private void boutonCheminActionPerformed(java.awt.event.ActionEvent evt) {
    // TODO add your handling code here:
    setAppMode(ApplicationMode.ADD_CHEMIN);
    this.controller.getNoeudForArcList().clear();
  } // GEN-LAST:event_boutonCheminActionPerformed

  private void dimensionTasActionPerformed(java.awt.event.ActionEvent evt) {}

  private void ajoutChargeurCoordActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_ajoutChargeurCoordActionPerformed

    int coordX = Integer.parseInt(xCoordSimul.getText());
    int coordY = Integer.parseInt(yCoordSimul.getText());
    Point point = new Point(coordX, coordY);

    this.controller.addChargeur(point);
    drawingPanel.repaint();
    simulationTextField();
  } // GEN-LAST:event_ajoutChargeurCoordActionPerformed

  private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {
    double angle = Double.parseDouble(angleSpinner.getText());
    if (this.currentApplicationMode != ApplicationMode.ADD_PLAN) {
      setAppMode(ApplicationMode.ADD_PLAN);
    }
    this.selectedEquipementMode = EquipementModes.TAS;

    int coordX = Integer.parseInt(textFieldCoordonneeX.getText());
    int coordY = Integer.parseInt(textFieldCoordonneeY.getText());

    Point point = new Point(coordX, coordY);

    String code = (String) comboBoxMateriaux.getSelectedItem();

    this.controller.addTas(point, code, angle);
    drawingPanel.repaint();
    rafraichissementTextField();
  } // GEN-LAST:event_jButton2ActionPerformed

  private void ajoutNoeudCoordActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_ajoutNoeudCoordActionPerformed
    if (this.currentApplicationMode != ApplicationMode.ADD_PLAN) {
      setAppMode(ApplicationMode.ADD_PLAN);
    }
    this.selectedEquipementMode = EquipementModes.NOEUD;

    int coordX = Integer.parseInt(textFieldCoordonneeX.getText());
    int coordY = Integer.parseInt(textFieldCoordonneeY.getText());

    Point point = new Point(coordX, coordY);
    this.controller.addNoeud(point, this.selectedEquipementMode, 0);
    drawingPanel.repaint();
    rafraichissementTextField();
  } // GEN-LAST:event_ajoutNoeudCoordActionPerformed

  private void modifierCamionActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_modifierCamionActionPerformed
    // TODO add your handling code here:
    String nomClient = NomClient.getText();
    String materiau = (String) materiauxComboBox.getSelectedItem();
    double quantite = (Integer) quantiteSpinner.getValue();
    int temps = (Integer) tempsAttente.getValue();

    if (nomClient.isEmpty()) {
      JOptionPane.showMessageDialog(null, "Attention, vous devez entrer un nom valide");
    } else if (quantite <= 0) {
      JOptionPane.showMessageDialog(
          null, "Attention, vous devez entrer un chiffre plus grand que zéro");
    } else {
      for (Camion camion : controller.getCamionList()) {
        if (camion.isSelected()) {
          controller.EditCamion(camion, nomClient, materiau, quantite);
          camion.setTempsAttente(temps);
        }
      }
      drawingPanel.repaint();
      simulationTextField();
    }
  } // GEN-LAST:event_modifierCamionActionPerformed

  private void ajoutModifChargeurActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_ajoutModifChargeurActionPerformed
    List<Chargeur> chargeurs = controller.getChargeurList();

    int coordX = Integer.parseInt(xCoordSimul.getText());
    int coordY = Integer.parseInt(yCoordSimul.getText());
    Point point = new Point(coordX, coordY);

    for (Chargeur chargeur : chargeurs) {
      if (chargeur.isSelected()) {
        chargeur.setPoint(point);
      }
    }
    drawingPanel.repaint();
    simulationTextField();
  } // GEN-LAST:event_ajoutModifChargeurActionPerformed

  private void ajoutNoeudActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_ajoutNoeudActionPerformed
    if (this.currentApplicationMode != ApplicationMode.ADD_PLAN) {
      setAppMode(ApplicationMode.ADD_PLAN);
    }
    this.setMode(EquipementModes.NOEUD);
  } // GEN-LAST:event_ajoutNoeudActionPerformed

  private void ajoutTasActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_ajoutTasActionPerformed
    if (this.currentApplicationMode != ApplicationMode.ADD_PLAN) {
      setAppMode(ApplicationMode.ADD_PLAN);
    }
    this.setMode(EquipementModes.TAS);
  }

  private void deleteSimulActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_deleteSimulActionPerformed
    List<Chargeur> chargeurs = controller.getChargeurList();
    List<Camion> camions = controller.getCamionList();

    for (Chargeur chargeur : chargeurs) {
      if (chargeur.isSelected()) {
        controller.removeChargeur(chargeur);
        drawingPanel.repaint();
      }
    }

    for (Camion camion : camions) {
      if (camion.isSelected()) {
        controller.removeCamion(camion);
        drawingPanel.repaint();
      }
    }
    drawingPanel.repaint();
    simulationTextField();
  } // GEN-LAST:event_deleteSimulActionPerformed

  private void selectionSimulActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_selectionSimulActionPerformed
    this.setAppMode(ApplicationMode.SELECT_SIMUL);
  } // GEN-LAST:event_selectionSimulActionPerformed

  private void StartSimulationActionPerformed(java.awt.event.ActionEvent evt) {
    List<Chargeur> chargeurs = controller.getChargeurList();
    if (chargeurs.size() == 0) {
      JOptionPane.showMessageDialog(
          null, "Attention un chargeur est nécessaire pour votre simulation");
    } else {
      for (Camion camionCourant : controller.getCamionList()) {
        TextSimulation.append(
            "\n\nTemps d'attente du camion  : " + camionCourant.getTempsAttente() + "secondes");
        if (camionCourant.getTempsAttente() == 0) {
          cheminAllerSimulation(camionCourant);
        } else {
          new Timer(
                  1000,
                  new ActionListener() {
                    private int count = 0;

                    @Override
                    public void actionPerformed(ActionEvent e) {
                      if (count < camionCourant.getTempsAttente()) {
                        count++;
                      } else {
                        ((Timer) e.getSource()).stop();
                        cheminAllerSimulation(camionCourant);
                      }
                    }
                  })
              .start();
        }
      }
    }
  }

  public static double angleOf(Point p1, Point p2) {
    final double deltaX = (p2.x - p1.x);
    final double deltaY = (p2.y - p1.y);
    return Math.atan2(deltaY, deltaX);
  }

  public void cheminAllerSimulation(Camion camionCourant) {
    List<Equipement> EquipementList = controller.getEquipementList();

    List<Tas> listeTas = new LinkedList<>();

    for (Equipement equipement : EquipementList) {
      if (equipement.getName().equals("Tas")) {
        Tas tas = (Tas) equipement;
        listeTas.add(tas);
      }
    }

    TextSimulation.append(
        "\n\nLa simulation commence pour le camion : " + camionCourant.getJeton().getRefClient());

    TextSimulation.append(
        "\n\n Vitesse : "
            + (int) UnitConverter.ConvertSpeedToKm(simulationSpeed, intervalle)
            + "km/h");

    controller.setGraphCheminSimulation(controller.getGraphChemin());

    Jeton jetonCamionCourant = camionCourant.getJeton();

    TextSimulation.append("\n\nInformation sur le jeton liée avec la commande");
    TextSimulation.append("\n\nRéference Client : " + jetonCamionCourant.getRefClient());
    TextSimulation.append("\n\nCode du produit : " + jetonCamionCourant.getCodeProduit());
    TextSimulation.append("\n\nQuantité du produit : " + jetonCamionCourant.getQuantite());
    TextSimulation.append("\n\nÉtat : " + jetonCamionCourant.getEtat());

    Tas tasSimulation =
        controller.TrouverTasCorrespondant(listeTas, jetonCamionCourant.getCodeProduit());

    Chargeur courantChargeur = controller.choisirChargeurCorrespondant(tasSimulation);

    TextSimulation.append(
        "\n\nPoint du chargeur correspondant : " + courantChargeur.getPoint().toString());

    courantChargeur.setJeton(jetonCamionCourant);

    camionCourant.changeEtat("ENCOURS");

    TextSimulation.append("\n\nNouvelle était : " + camionCourant.getEtat());

    Vector<AbstractPointChemin> cheminCamionAller = controller.cheminDuCamion(tasSimulation);

    Vector<AbstractPointChemin> cheminChargeur =
        controller.ChargeurCheminToPath(courantChargeur, tasSimulation, controller.getAllNoeuds());

    final int maxSizeCamionAller = cheminCamionAller.size();

    final int maxSizeChargeur = cheminChargeur.size();
    new Timer(
            intervalle,
            new ActionListener() {
              private int count = 0;
              private int chargeurCount = 0;
              private double angle = 0;
              private double angleChargeur = 0;

              Point entreeCarriere = controller.getEntree().getPoint();

              int x = entreeCarriere.x;
              int y = entreeCarriere.y;
              int chargeur_x = courantChargeur.getPointInitial().x;
              int chargeur_y = courantChargeur.getPointInitial().y;

              @Override
              public void actionPerformed(ActionEvent evt) {
                if (pauseSimulation) {
                } else if (!pauseSimulation
                    && (chargeurCount < maxSizeChargeur || count < maxSizeCamionAller)) {

                  if (chargeurCount < maxSizeChargeur) {
                    if (chargeurCount == 0) {

                      angleChargeur =
                          angleOf(
                              courantChargeur.getPointInitial(),
                              cheminChargeur.get(chargeurCount).getPoint());
                    } else {
                      angleChargeur =
                          angleOf(
                              cheminChargeur.get(chargeurCount - 1).getPoint(),
                              cheminChargeur.get(chargeurCount).getPoint());
                    }

                    chargeur_x = chargeur_x + (int) (Math.cos(angleChargeur) * simulationSpeed);
                    chargeur_y = chargeur_y + (int) (Math.sin(angleChargeur) * simulationSpeed);
                    courantChargeur.setPoint(new Point(chargeur_x, chargeur_y));
                    courantChargeur.setAngle(Math.toDegrees(angleChargeur));
                    drawingPanel.repaint();
                    if (chargeur_x >= cheminChargeur.get(chargeurCount).getPoint().x) {
                      chargeurCount++;
                    }
                  }
                  if (count < maxSizeCamionAller) {
                    if (count == 0) {
                      angle = angleOf(entreeCarriere, cheminCamionAller.get(count).getPoint());
                    } else {
                      angle =
                          angleOf(
                              cheminCamionAller.get(count - 1).getPoint(),
                              cheminCamionAller.get(count).getPoint());
                    }
                    x = x + (int) (Math.cos(angle) * simulationSpeed);
                    y = y + (int) (Math.sin(angle) * simulationSpeed);
                    camionCourant.setPoint(new Point(x, y));
                    camionCourant.setAngle(Math.toDegrees(angle));
                    drawingPanel.repaint();
                    if (x >= cheminCamionAller.get(count).getPoint().x) {
                      count++;
                    }
                  }
                } else {
                  ((Timer) evt.getSource()).stop();
                  chargementSimulation(camionCourant, courantChargeur, tasSimulation);
                }
              }
            })
        .start();
  }

  private void chargementSimulation(Camion camionCourant, Chargeur chargeurCourant, Tas p_tas) {
    new Timer(
            1000,
            new ActionListener() {

              private int count = 0;

              @Override
              public void actionPerformed(ActionEvent evt) {
                if (pauseSimulation) {
                } else if (count < 5 && !pauseSimulation) {
                  if (count == 0) {
                    if (controller.verificationJeton(camionCourant, chargeurCourant)) {
                      TextSimulation.append(
                          "\n\nJeton du camion et du chargeur sont identiques ! ");
                      TextSimulation.append("\n\nChargement en cours  ! ");
                      TextSimulation.append("\n\nVeuillez patientez  ! ");

                    } else {
                      TextSimulation.append("\n\nLes jetons ne sont pas identiques");
                      count = 6;
                    }
                  }
                  if (count == 4) {

                    camionCourant.changeEtat("LIVRER");

                    TextSimulation.append(
                        "\n\nNouvelle était du camion : " + camionCourant.getEtat());

                    TextSimulation.append("\n\nFin du chargement ! ");

                    TextSimulation.append("\n\nLe camion retourne a l'entrée");
                  }
                  count++;
                } else {
                  ((Timer) evt.getSource()).stop();

                  simulationCamionRetour(camionCourant, p_tas);
                }
              }
            })
        .start();
  }

  public void simulationCamionRetour(Camion p_camion, Tas p_tas) {

    Vector<AbstractPointChemin> cheminCamionRetour = controller.cheminDuCamionRetour(p_tas);
    TextSimulation.append("\n\nDebut du retour");

    new Timer(
            intervalle,
            new ActionListener() {

              private int count = 0;
              double angle = 0;
              private int maxSizeCamionRetour = cheminCamionRetour.size();
              int x = p_tas.getPointChargement().getPoint().x;
              int y = p_tas.getPointChargement().getPoint().y;
              Point newPoint;
              Point point = p_tas.getPointChargement().getPoint();
              int moveX = point.x;
              int moveY = point.y;

              @Override
              public void actionPerformed(ActionEvent e) {
                if (pauseSimulation) {
                  System.out.println("Simulation en pause");
                } else if (count < maxSizeCamionRetour && !pauseSimulation) {
                  if (count == 0) {
                    angle =
                        angleOf(
                            p_tas.getPointChargement().getPoint(),
                            cheminCamionRetour.get(count).getPoint());
                    newPoint =
                        new Point(
                            cheminCamionRetour.get(count).getPoint().x
                                - p_tas.getPointChargement().getPoint().x,
                            cheminCamionRetour.get(count).getPoint().y
                                - p_tas.getPointChargement().getPoint().y);
                  } else {
                    angle =
                        angleOf(
                            cheminCamionRetour.get(count - 1).getPoint(),
                            cheminCamionRetour.get(count).getPoint());
                    newPoint =
                        new Point(
                            cheminCamionRetour.get(count).getPoint().x
                                - cheminCamionRetour.get(count - 1).getPoint().x,
                            cheminCamionRetour.get(count).getPoint().y
                                - cheminCamionRetour.get(count - 1).getPoint().y);
                  }

                  int cosinus = (int) (-1 * Math.cos(angle) * simulationSpeed);
                  int sinus = (int) (-1 * Math.sin(angle) * simulationSpeed);

                  moveX = x - cosinus;
                  moveY = y - sinus;

                  x = x + newPoint.x / simulationSpeed;
                  y = y + newPoint.y / simulationSpeed;
                  p_camion.setPoint(new Point(moveX, moveY));
                  p_camion.setAngle(Math.toDegrees(angle));
                  drawingPanel.repaint();
                  if (x <= cheminCamionRetour.get(count).getPoint().x) {
                    count++;
                  }

                } else {
                  ((Timer) e.getSource()).stop();
                  genererFacture(p_camion, p_camion.getJeton());
                }
              }
            })
        .start();
  }

  public void genererFacture(Camion camionCourant, Jeton jetonCamion) {
    camionCourant.changeEtat("FACTURE");

    TextSimulation.append("\n\nNouvelle état du camion :  " + camionCourant.getEtat());

    Facture factureCamion = new Facture(jetonCamion.getCodeProduit(), jetonCamion.getQuantite());

    camionCourant.setFacture(factureCamion);

    double prixFacture = camionCourant.getFacture().getPrice();

    TextSimulation.append("\n\nLa facture s'éleve à un montant de  :  " + prixFacture + "$");

    camionCourant.payeFacture();

    if (camionCourant.verifierFacturePayer()) {
      TextSimulation.append(
          "\n\nLa facture a bien été payée, la simulation est fini pour le camion : "
              + jetonCamion.getRefClient());

      camionCourant.changeEtat("PAYÉ");

      TextSimulation.append("\n\nNouvelle état du camion :  " + camionCourant.getEtat());

      TextSimulation.append(
          "\n\nFin de la simulation pour le camion, : " + jetonCamion.getRefClient());

      TextSimulation.append("\n\nLe camion s'en va de la carrière");

      controller.removeCamion(camionCourant);

    } else {
      TextSimulation.append(
          "\n\nLa facture n'as pas bien été payé pour le camion  : " + jetonCamion.getRefClient());
    }
  }

  private void jButton6ActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_jButton6ActionPerformed
    // TODO add your handling code here:
  } // GEN-LAST:event_jButton6ActionPerformed

  private void deleteButtonMousePressed(
      java.awt.event.MouseEvent evt) { // GEN-FIRST:event_deleteButtonMousePressed
    // TODO add your handling code here:
  } // GEN-LAST:event_deleteButtonMousePressed

  private void deleteButtonMouseClicked(
      java.awt.event.MouseEvent evt) { // GEN-FIRST:event_deleteButtonMouseClicked
    // TODO add your handling code here:
  } // GEN-LAST:event_deleteButtonMouseClicked

  private void deleteButtonKeyPressed(
      java.awt.event.KeyEvent evt) { // GEN-FIRST:event_deleteButtonKeyPressed
    // TODO add your handling code here:
  } // GEN-LAST:event_deleteButtonKeyPressed

  private void modeSelectionKeyPressed(
      java.awt.event.KeyEvent evt) { // GEN-FIRST:event_modeSelectionKeyPressed
    // TODO add your handling code here:
  } // GEN-LAST:event_modeSelectionKeyPressed

  private void nomMateriauActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_nomMateriauActionPerformed
    // TODO add your handling code here:
  } // GEN-LAST:event_nomMateriauActionPerformed

  private void NomClientActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_NomClientActionPerformed
  } // GEN-LAST:event_NomClientActionPerformed

  private void ajoutBroyeurViaPopup(java.awt.event.ActionEvent evt) {
    System.out.println("On se rend tu ici");
    Point newPoint = new Point(MouseInfo.getPointerInfo().getLocation());
    Point point = new Point((int) newPoint.getX() + 40, (int) newPoint.getY());
    double angle = Double.parseDouble(angleSpinner.getText());
    controller.addEquipement(EquipementModes.BROYEUR, point, angle);
    controller.addConvoyeur(point, EquipementModes.CONVOYEUR, angle);
    drawingPanel.repaint();
  }

  private void ajoutCribleViaPopup(java.awt.event.ActionEvent evt) {
    Point newPoint = new Point(MouseInfo.getPointerInfo().getLocation());
    Point point = new Point((int) newPoint.getX() + 40, (int) newPoint.getY());
    double angle = Double.parseDouble(angleSpinner.getText());
    controller.addEquipement(EquipementModes.CRIBLE, point, angle);
    controller.addConvoyeur(point, EquipementModes.CONVOYEUR, angle);
    drawingPanel.repaint();
  }

  private void ajoutConcasseurViaPopup(java.awt.event.ActionEvent evt) {
    Point newPoint = new Point(MouseInfo.getPointerInfo().getLocation());
    Point point = new Point((int) newPoint.getX() + 40, (int) newPoint.getY());
    double angle = Double.parseDouble(angleSpinner.getText());
    controller.addEquipement(EquipementModes.CONCASSEUR, point, angle);
    controller.addConvoyeur(point, EquipementModes.CONVOYEUR, angle);
    equipementsPopup.clear();
    drawingPanel.repaint();
  }

  private void addCamionActionPerformed(java.awt.event.ActionEvent evt) {
    Entree entrees = controller.getEntree();
    Point point = entrees.getPoint();
    String nomClient = NomClient.getText();
    String materiau = (String) materiauxComboBox.getSelectedItem();
    double quantite = (Integer) quantiteSpinner.getValue();
    int temps = (Integer) tempsAttente.getValue();

    if (nomClient.isEmpty()) {
      JOptionPane.showMessageDialog(null, "Attention, vous devez entrer un nom valide");
    } else if (quantite <= 0) {
      JOptionPane.showMessageDialog(
          null, "Attention, vous devez entrer un chiffre plus grand que zéro");
    } else {

      int index = 0;
      // mettre la camion dans la file d'attente
      for (Camion camion : controller.getCamionList()) {
        index++;
      }

      Point newPoint = new Point(point.x - (70 * index), point.y);

      controller.addCamion(newPoint, nomClient, materiau, quantite, temps);
      drawingPanel.repaint();
      simulationTextField();
    }
  }

  public void simulationTextField() {
    TextSimulation.setText("");
    NomClient.setText("");
    xCoordSimul.setText("");
    yCoordSimul.setText("");
    List<Camion> camions = controller.getCamionList();
    List<Chargeur> chargeurs = controller.getChargeurList();

    for (Camion camion : camions) {
      if (camion.isSelected()) {
        String codeProduit = camion.getJeton().getCodeProduit();
        String nomClient = camion.getJeton().getRefClient();
        int quantite = (int) camion.getJeton().getQuantite();

        String laQuantite = String.format("%d", quantite);

        TextSimulation.append("\n\nNom du client : " + nomClient);
        TextSimulation.append("\nCode du produit demandé : " + codeProduit);
        TextSimulation.append("\nQuantité demandé : " + laQuantite);
        TextSimulation.append("\nTemps d'attente en secondes  : " + camion.getTempsAttente());

        NomClient.setText(nomClient);
      }
    }

    for (Chargeur chargeur : chargeurs) {
      if (chargeur.isSelected()) {
        int xCoord = (int) chargeur.getX();
        int yCoord = (int) chargeur.getY();

        String x = String.format("%d", xCoord);
        String y = String.format("%d", yCoord);

        xCoordSimul.setText(x);
        yCoordSimul.setText(y);
      }
    }
  }

  private void deleteButtonActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_deleteButtonActionPerformed
    List<Equipement> equipements = controller.getEquipementList();
    List<AbstractPointChemin> noeuds = controller.getNoeudList();
    ArrayList<List<Arc>> arcs = controller.getArcList();
    ArrayList<List<Convoyeur>> convoyeurs = controller.getConvoyeurList();

    for (Equipement equipement : equipements) {
      if (equipement.isSelected()) {
        controller.removeEquipement(equipement);
        drawingPanel.repaint();
      }
    }

    for (AbstractPointChemin noeud : noeuds) {
      if (noeud.isSelected()) {
        controller.removeNoeud(noeud);
        drawingPanel.repaint();
      }
    }

    for (List<Arc> arcList : arcs) {
      List<Arc> arcSupprime = new ArrayList<>();
      for (Arc arc : arcList) {
        if (arc.isSelected()) {
          arcSupprime.add(arc);
        }
      }
      for (Arc arcc : arcSupprime) {
        controller.removeArc(arcc);
        drawingPanel.repaint();
      }
    }

    for (List<Convoyeur> convoyeurList : convoyeurs) {
      List<Convoyeur> convSupprime = new ArrayList<>();
      for (Convoyeur conv : convoyeurList) {
        if (conv.isSelected()) {
          convSupprime.add(conv);
        }
      }
      for (Convoyeur convoyeur : convSupprime) {
        controller.removeConvoyeur(convoyeur);
        drawingPanel.repaint();
      }
    }

    rafraichissementTextField();
    drawingPanel.repaint();
  } // GEN-LAST:event_deleteButtonActionPerformed

  private void textFieldCoordonneeXActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_textFieldCoordonneeXActionPerformed
  } // GEN-LAST:event_textFieldCoordonneeXActionPerformed

  private void ajoutChargeurActionPerformed(java.awt.event.ActionEvent evt) {
    if (this.currentApplicationMode != ApplicationMode.ADD_SIMULATION) {
      setAppMode(ApplicationMode.ADD_SIMULATION);
    }
    this.setVehicule(VehiculeModes.CHARGEUR);
  }

  private void drawingPanelKeyPressed(java.awt.event.KeyEvent evt) {
    if (evt.getKeyCode() == KeyEvent.VK_BACK_SPACE || evt.getKeyCode() == KeyEvent.VK_DELETE) {
      List<Equipement> equipements = controller.getEquipementList();
      List<AbstractPointChemin> noeuds = controller.getNoeudList();
      ArrayList<List<Arc>> arcs = controller.getArcList();
      List<Chargeur> chargeurs = controller.getChargeurList();
      Entree entree = controller.getEntree();
      ArrayList<List<Convoyeur>> convoyeurs = controller.getConvoyeurList();

      for (List<Convoyeur> convoyeurList : convoyeurs) {
        for (Convoyeur convoyeur : convoyeurList) {
          if (convoyeur.isSelected()) {
            controller.removeConvoyeur(convoyeur);
            drawingPanel.repaint();
          }
        }
      }

      for (Equipement equipement : equipements) {
        if (equipement.isSelected()) {
          controller.removeEquipement(equipement);
          drawingPanel.repaint();
        }
      }

      for (Chargeur chargeur : chargeurs) {
        if (chargeur.isSelected()) {
          controller.removeChargeur(chargeur);
          drawingPanel.repaint();
        }
      }

      for (AbstractPointChemin noeud : noeuds) {
        if (noeud.isSelected()) {
          controller.removeNoeud(noeud);
          drawingPanel.repaint();
        }
      }

      for (List<Arc> arcList : arcs) {
        for (Arc arc : arcList) {
          if (arc.isSelected()) {
            controller.removeArc(arc);
            drawingPanel.repaint();
          }
        }
      }
      rafraichissementTextField();
      drawingPanel.repaint();
    }
  } // GEN-LAST:event_drawingPanelKeyPressed

  private void resetGrilleActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_resetGrilleActionPerformed
    double gapGrille = 100;
    this.drawingPanel.setGapGrille(gapGrille);
    this.drawingPanel.repaint();
  } // GEN-LAST:event_resetGrilleActionPerformed

  private void modifierGrilleActionPerformed(java.awt.event.ActionEvent evt) {
    JPanel fields = new JPanel(new GridLayout(2, 2));
    JTextField textField = new JTextField();
    textField.setPreferredSize(new Dimension(11, 15));
    JLabel label = new JLabel("mètres");

    fields.add(textField);
    fields.add(label);

    int result =
        JOptionPane.showConfirmDialog(
            null,
            fields,
            "Entrer les dimensions d'un carré de la grille",
            JOptionPane.OK_CANCEL_OPTION,
            JOptionPane.QUESTION_MESSAGE);

    if (result == JOptionPane.OK_OPTION) {
      double newGridGap;
      try {
        newGridGap = Double.parseDouble(textField.getText());
      } catch (Exception exc) {
        JOptionPane.showMessageDialog(null, "La valeur entrée n'est pas un chiffre valide");
        return;
      }
      if (newGridGap <= 0) {
        JOptionPane.showMessageDialog(null, "La valeur entrée doit être plus grande que zéro");
        throw new ArithmeticException("Negative grid gap.");
      }
      newGridGap = UnitConverter.pixelToMeter(newGridGap);
      this.drawingPanel.setGapGrille(newGridGap);
    }
    this.drawingPanel.repaint();
  }

  private void ajoutNoeudCoordButtonActionPerformed(java.awt.event.ActionEvent evt) {
    List<AbstractPointChemin> noeuds = controller.getNoeudList();
    this.selectedEquipementMode = EquipementModes.NOEUD;

    int coordX = Integer.parseInt(textFieldCoordonneeX.getText());
    int coordY = Integer.parseInt(textFieldCoordonneeY.getText());

    Point point = new Point(coordX, coordY);

    for (AbstractPointChemin noeud : noeuds) {
      if (noeud.isSelected()) {
        noeud.setPoint(point);
      }
    }
    drawingPanel.repaint();
    rafraichissementTextField();
  }

  private void ajoutTasCoordButtonActionPerformed(java.awt.event.ActionEvent evt) {

    this.selectedEquipementMode = EquipementModes.TAS;
    List<Equipement> equipements = controller.getEquipementList();

    int coordX = Integer.parseInt(textFieldCoordonneeX.getText());
    int coordY = Integer.parseInt(textFieldCoordonneeY.getText());
    String newCode = (String) comboBoxMateriaux.getSelectedItem();
    int dimension = Integer.parseInt(dimensionTas.getText());

    Point point = new Point(coordX, coordY);

    for (Equipement equipement : equipements) {
      if (equipement.getName().equals("Tas")) {
        if (equipement.isSelected()) {
          Tas tas = (Tas) equipement;
          tas.setPoint(point);
          tas.setMaterialCode(newCode);
          tas.setDimension(dimension);
        }
      }
    }
    drawingPanel.repaint();
    rafraichissementTextField();
  }

  private void jTabbedPaneStateChanged(
      javax.swing.event.ChangeEvent evt) { // GEN-FIRST:event_jTabbedPaneStateChanged
    // TODO add your handling code here:
    if (jTabbedPane.getSelectedIndex() == 0) {
      if (this.currentApplicationMode != ApplicationMode.ADD_PLAN) {
        setAppMode(ApplicationMode.ADD_PLAN);
      }
    } else {
      if (this.currentApplicationMode != ApplicationMode.ADD_SIMULATION) {
        setAppMode(ApplicationMode.ADD_SIMULATION);
      }

      if (!controller.validateDependencies()) {
        jTabbedPane.setSelectedIndex(0);
        JOptionPane.showMessageDialog(
            null,
            "Attention, il y a des erreurs dans votre Plan concernant les équipements.\n"
                + "Veuillez les corriger.\nRappel :\n"
                + "Un crible doit être reliée à un broyeur\n"
                + "Un broyeur doit être relié à une crible ou un concasseur\n"
                + "Un concasseur doit être relié à un broyeur");
      }
    }
  } // GEN-LAST:event_jTabbedPaneStateChanged

  private void menuSauvegarderSousActionPerformed(java.awt.event.ActionEvent evt) {
    // TODO add your handling code here:
    this.controller.saveAs();
  }

  private void menuOuvrirProjetActionPerformed(java.awt.event.ActionEvent evt) {
    // TODO add your handling code here:
    this.controller.openFile();
  } // GEN-LAST:event_menuOuvrirProjetActionPerformed

  private void menuSauvegarderProjetActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_menuSauvegarderProjetActionPerformed
    // TODO add your handling code here:
    this.controller.save();
  } // GEN-LAST:event_menuSauvegarderProjetActionPerformed

  private void ajoutCamionKeyPressed(
      java.awt.event.KeyEvent evt) { // GEN-FIRST:event_ajoutCamionKeyPressed
    // TODO add your handling code here:
    this.setVehicule(VehiculeModes.CAMION);
  } // GEN-LAST:event_ajoutCamionKeyPressed

  private void entreeButtonKeyPressed(
      java.awt.event.KeyEvent evt) { // GEN-FIRST:event_entreeButtonKeyPressed
    // TODO add your handling code here:
  } // GEN-LAST:event_entreeButtonKeyPressed

  private void entreeButtonMousePressed(
      java.awt.event.MouseEvent evt) { // GEN-FIRST:event_entreeButtonMousePressed
    // TODO add your handling code here:
  } // GEN-LAST:event_entreeButtonMousePressed

  private void drawingPanelMouseClicked(java.awt.event.MouseEvent evt) {}

  private void arcButtonActionPerformed(java.awt.event.ActionEvent evt) {
    setAppMode(ApplicationMode.ADD_ARC);
    this.controller.getNoeudForArcList().clear();
  }

  private void entreeButtonActionPerformed(java.awt.event.ActionEvent evt) {

    if (this.currentApplicationMode != ApplicationMode.ADD_PLAN) {
      setAppMode(ApplicationMode.ADD_PLAN);
    }

    this.setMode(EquipementModes.ENTREE);
  }

  private void jTextArea1ComponentAdded(
      java.awt.event.ContainerEvent evt) { // GEN-FIRST:event_jTextArea1ComponentAdded
  } // GEN-LAST:event_jTextArea1ComponentAdded

  public void rafraichissementTextField() {
    jTextArea1.setText("");
    jTextField2.setText("0");
    angleSpinner.setText("0");
    textFieldCoordonneeX.setText("");
    textFieldCoordonneeY.setText("");
    dimensionTas.setText("");
    int numTotal = 0;
    int numNoeud = 0;
    int numTas = 0;
    int numArc = 0;
    int numConvoyeur = 0;
    List<Equipement> equipements = controller.getEquipementList();
    List<AbstractPointChemin> noeuds = controller.getNoeudList();
    ArrayList<List<Convoyeur>> convoyeurs = controller.getConvoyeurList();

    ArrayList<List<Arc>> arcs = controller.getArcList();

    for (Equipement equipement : equipements) {
      if (equipement.isSelected()) {
        numTotal++;
        String nom = String.format("\nCoordonnées du %s", equipement.getName());
        String xCoord = String.format(":\n x : %d", (int) equipement.getX());
        String yCoord = String.format(", y : %d", (int) equipement.getY());
        String angle = String.format("\n Angle : %f", equipement.getAngle());
        String nombreTotal = String.format("%d", numTotal);
        String angleText = String.format("%f", equipement.getAngle());
        jTextArea1.append(nom + xCoord + yCoord + angle);
        jTextField2.setText(nombreTotal);
        angleSpinner.setText(angleText);

        if (equipement.getName().equals("Tas")) {
          Tas tas = (Tas) equipement;
          String x = String.format("%d", (int) tas.getX());
          String y = String.format("%d", (int) tas.getY());
          String code = tas.getMaterialCode();
          String dimension = String.format("%d", tas.getDimension());
          jTextArea1.append("\n Code du matériau : " + code);
          textFieldCoordonneeX.setText(x);
          textFieldCoordonneeY.setText(y);
          dimensionTas.setText(dimension);
        }
      }
    }

    for (AbstractPointChemin noeud : noeuds) {
      if (noeud.getName().equals("Noeud")) {
        numNoeud++;
      }
      if (noeud.getName().equals("Tas")) {
        numTas++;
      }
      if (noeud.isSelected()) {
        numTotal++;
        String nom = String.format("\nCoordonnées du %s", noeud.getName());
        String num = String.format(" #%d", numNoeud);
        String xCoord = String.format(":\n x : %d", (int) noeud.getX());
        String yCoord = String.format(", y : %d", (int) noeud.getY());
        String nombreTotal = String.format("%d", numTotal);
        jTextArea1.append(nom + num + xCoord + yCoord);
        jTextField2.setText(nombreTotal);

        String x = String.format("%d", (int) noeud.getX());
        String y = String.format("%d", (int) noeud.getY());
        textFieldCoordonneeX.setText(x);
        textFieldCoordonneeY.setText(y);
      }
    }

    for (List<Convoyeur> listConvoyeur : convoyeurs) {
      for (Convoyeur convoyeur : listConvoyeur) {
        if (convoyeur.isSelected()) {
          numTotal++;
          numConvoyeur++;
          Point middlePoint =
              new Point(
                  convoyeur.middlePointOfConvoyeur(
                      (int) convoyeur.getStarting().getX(),
                      (int) convoyeur.getStarting().getY(),
                      (int) convoyeur.getArrival().getX(),
                      (int) convoyeur.getArrival().getY()));
          String nom = String.format("\nCoordonnées du point milieu du %s", convoyeur.getName());
          String num = String.format(" #%d", numConvoyeur);
          String xCoord = String.format(":\n x : %d", (int) middlePoint.getX());
          String yCoord = String.format(", y : %d", (int) middlePoint.getY());
          String nombreTotal = String.format("%d", numTotal);
          jTextArea1.append(nom + num + xCoord + yCoord);
          jTextField2.setText(nombreTotal);
        }
      }
    }

    for (List<Arc> listArc : arcs) {
      for (Arc arc : listArc)
        if (arc.isSelected()) {
          numTotal++;
          numArc++;
          String nom = String.format("\nCoordonnées du point milieu de l'%s", arc.getName());
          String num = String.format(" #%d", numArc);
          String xCoord = String.format(":\n x : %d", (int) arc.getX());
          String yCoord = String.format(", y : %d", (int) arc.getY());
          String nombreTotal = String.format("%d", numTotal);
          jTextArea1.append(nom + num + xCoord + yCoord);
          jTextField2.setText(nombreTotal);
        }
    }
  }

  private void drawingPanelMouseDragged(java.awt.event.MouseEvent evt) {
    Point mousePoint = evt.getPoint();
    double xCoord = mousePoint.getX();
    double yCoord = mousePoint.getY();
    drawingPanel.setMouseX(xCoord);
    drawingPanel.setMouseY(yCoord);
    drawingPanel.repaint();

    if (SwingUtilities.isRightMouseButton(evt)) {
      double deltaX =
          (((int) evt.getX() / drawingPanel.getZoom()) - (int) (this.currentMousePoint.getX()));
      double deltaY =
          (((int) evt.getY() / drawingPanel.getZoom()) - (int) (this.currentMousePoint.getY()));
      this.controller.updateSelectedItemsPositions(deltaX, deltaY);

      this.currentMousePoint =
          new Point(
              (int) (evt.getX() / drawingPanel.getZoom()),
              (int) (evt.getY() / drawingPanel.getZoom()));
      drawingPanel.repaint();
      rafraichissementTextField();
      simulationTextField();
    }
  }

  private void ajoutSimulationActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_ajoutSimulationActionPerformed
    this.setAppMode(ApplicationMode.ADD_SIMULATION);
  } // GEN-LAST:event_ajoutSimulationActionPerformed

  private void ajoutElementActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_ajoutElementActionPerformed
    this.setAppMode(ApplicationMode.ADD_PLAN);
  } // GEN-LAST:event_ajoutElementActionPerformed

  private void drawingPanelMouseWheelMoved(java.awt.event.MouseWheelEvent evt) {
    Point point = evt.getPoint();
    this.currentMousePoint = evt.getPoint();
    if (evt.getPreciseWheelRotation() > 0) {
      drawingPanel.zoomIn(point);
      drawingPanel.repaint();
    } else {
      drawingPanel.zoomOut(point);
    }
    drawingPanel.repaint();
  } // GEN-LAST:event_drawingPanelMouseWheelMoved

  private void jComboBox1ActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_jComboBox1ActionPerformed

    if (this.currentApplicationMode != ApplicationMode.ADD_PLAN) {
      setAppMode(ApplicationMode.ADD_PLAN);
    }
    if (jComboBox1.getSelectedItem() == "Broyeur") {
      this.setMode(EquipementModes.BROYEUR);

    } else if (jComboBox1.getSelectedItem() == "Concasseur") {
      this.setMode(EquipementModes.CONCASSEUR);

    } else if (jComboBox1.getSelectedItem() == "Crible") {
      this.setMode(EquipementModes.CRIBLE);

    } else if (jComboBox1.getSelectedItem() == "Convoyeur") {
      this.setMode(EquipementModes.CONVOYEUR);
      controller.clearEquipementConv();
    } else if (jComboBox1.getSelectedItem() == "Sélectionner") {
      this.setMode(EquipementModes.RIEN);
    }
  }

  private void modeSelectionActionPerformed(java.awt.event.ActionEvent evt) {
    this.setAppMode(ApplicationMode.SELECT);
  }

  private void drawingPanelMousePressed(java.awt.event.MouseEvent evt) {
    Point mousePoint = evt.getPoint();
    this.initMousePoint =
        new Point(
            (int) (evt.getX() / drawingPanel.getZoom()),
            (int) (evt.getY() / drawingPanel.getZoom()));

    this.currentMousePoint = new Point(this.initMousePoint);
    this.requestFocus();

    if (this.currentApplicationMode == ApplicationMode.SELECT
        && SwingUtilities.isLeftMouseButton(evt)) {
      double xPos = this.currentMousePoint.getX();
      double yPos = this.currentMousePoint.getY();
      this.controller.switchSelectionStatus(xPos, yPos, evt.isShiftDown());
      rafraichissementTextField();
      drawingPanel.repaint();

    } else if (this.currentApplicationMode == ApplicationMode.ADD_PLAN
        && SwingUtilities.isLeftMouseButton(evt)) {
      if (drawingPanel.getGridlines()) {
        int coordX =
            (int) (this.initMousePoint.getX() / drawingPanel.getGapGrille())
                * (int) drawingPanel.getGapGrille();
        int coordY =
            (int) (this.initMousePoint.getY() / drawingPanel.getGapGrille())
                * (int) drawingPanel.getGapGrille();
        Point apoint = new Point(coordX, coordY);
        double angle = Double.parseDouble(angleSpinner.getText());
        Controller.EquipementModes actualEquipement = this.selectedEquipementMode;
        this.controller.addEquipement(actualEquipement, apoint, angle);
        drawingPanel.repaint();

      } else {
        Point point = new Point((int) this.initMousePoint.getX(), (int) this.initMousePoint.getY());
        double angle = Double.parseDouble(angleSpinner.getText());
        if (this.selectedEquipementMode == EquipementModes.TAS) {
          String code = (String) comboBoxMateriaux.getSelectedItem();
          this.controller.addTas(point, code, 180);
        }
        Controller.EquipementModes actualEquipement = this.selectedEquipementMode;
        this.controller.addEquipement(actualEquipement, point, angle);

        drawingPanel.repaint();
      }

    } else if (this.currentApplicationMode == ApplicationMode.ADD_SIMULATION
        && SwingUtilities.isLeftMouseButton(evt)) {
      Point point = new Point((int) this.initMousePoint.getX(), (int) this.initMousePoint.getY());
      controller.addChargeur(point);

      drawingPanel.repaint();

    } else if (this.currentApplicationMode == ApplicationMode.ADD_ARC
        && SwingUtilities.isLeftMouseButton(evt)) {
      Point point = new Point((int) this.initMousePoint.getX(), (int) this.initMousePoint.getY());

      this.controller.addArc(point);

      drawingPanel.repaint();

    } else if (this.currentApplicationMode == ApplicationMode.SELECT_SIMUL
        && SwingUtilities.isLeftMouseButton(evt)) {
      double xPos = this.currentMousePoint.getX();
      double yPos = this.currentMousePoint.getY();
      this.controller.changementSelectionStatus(xPos, yPos);
      drawingPanel.repaint();
      simulationTextField();

    } else if (this.currentApplicationMode == ApplicationMode.ADD_CHEMIN
        && SwingUtilities.isLeftMouseButton(evt)) {
      Point point = new Point((int) this.initMousePoint.getX(), (int) this.initMousePoint.getY());

      this.controller.addChemin(point);

      drawingPanel.repaint();
    }
  }

  private void drawingPanelMouseMoved(java.awt.event.MouseEvent evt) {
    Point mousePoint = evt.getPoint();
    drawingPanel.setMouseX(mousePoint.getX());
    drawingPanel.setMouseY(mousePoint.getY());
    drawingPanel.repaint();
  }

  private void formMouseWheelMoved(java.awt.event.MouseWheelEvent evt) {}

  private void mainScrollPaneMouseWheelMoved(java.awt.event.MouseWheelEvent evt) {
    Point point = evt.getPoint();
    this.currentMousePoint = evt.getPoint();
    if (evt.getPreciseWheelRotation() > 0) {
      drawingPanel.zoomIn(point);
    } else {
      drawingPanel.zoomOut(point);
    }
  }

  private void menuNouveauProjetActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_menuNouveauProjetActionPerformed
    // TODO add your handling code here:
    this.controller.newProject();
  } // GEN-LAST:event_menuNouveauProjetActionPerformed

  private void menuQuitterActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_menuQuitterActionPerformed
    System.exit(0);
  } // GEN-LAST:event_menuQuitterActionPerformed

  private void menuAffichageGrilleActionPerformed(
      java.awt.event.ActionEvent evt) { // GEN-FIRST:event_menuAffichageGrilleActionPerformed
    drawingPanel.setGridLines();
  } // GEN-LAST:event_menuAffichageGrilleActionPerformed

  private void menuAffichageGrilleMouseClicked(
      java.awt.event.MouseEvent evt) { // GEN-FIRST:event_menuAffichageGrilleMouseClicked
    // TODO add your handling code here:
  } // GEN-LAST:event_menuAffichageGrilleMouseClicked

  /** @param args the command line arguments */
  public static void main(String args[]) {
    /* Set the Nimbus look and feel */
    // <editor-fold defaultstate="collapsed" desc=" Look and feel setting code
    // (optional) ">
    /*
     * If Nimbus (introduced in Java SE 6) is not available, stay with the default
     * look and feel. For details see
     * http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html
     */
    try {
      for (javax.swing.UIManager.LookAndFeelInfo info :
          javax.swing.UIManager.getInstalledLookAndFeels()) {
        if ("Nimbus".equals(info.getName())) {
          javax.swing.UIManager.setLookAndFeel(info.getClassName());
          break;
        }
      }
    } catch (ClassNotFoundException ex) {
      java.util.logging.Logger.getLogger(MainWindow.class.getName())
          .log(java.util.logging.Level.SEVERE, null, ex);
    } catch (InstantiationException ex) {
      java.util.logging.Logger.getLogger(MainWindow.class.getName())
          .log(java.util.logging.Level.SEVERE, null, ex);
    } catch (IllegalAccessException ex) {
      java.util.logging.Logger.getLogger(MainWindow.class.getName())
          .log(java.util.logging.Level.SEVERE, null, ex);
    } catch (javax.swing.UnsupportedLookAndFeelException ex) {
      java.util.logging.Logger.getLogger(MainWindow.class.getName())
          .log(java.util.logging.Level.SEVERE, null, ex);
    }
    // </editor-fold>

    /* Create and display the form */
    java.awt.EventQueue.invokeLater(
        new Runnable() {
          public void run() {
            new MainWindow().setVisible(true);
          }
        });
  }

  public Dimension getMainScrollPaneDimension() {
    return mainScrollPane.getSize();
  }

  public JScrollPane getMainScrollPane() {
    return this.mainScrollPane;
  }

  public void setMainScrollPanePosition(Point point) {
    this.mainScrollPane.getViewport().setViewPosition(point);
  }

  private JMenuItem ajoutBroyeurPopup = new JMenuItem("Ajouter un broyeur");
  private JMenuItem ajoutCriblePopup = new JMenuItem("Ajouter un crible");
  private JMenuItem ajoutConcasseurPopup = new JMenuItem("Ajouter un concasseur");

  // Variables declaration - do not modify//GEN-BEGIN:variables
  private javax.swing.JTextField NomClient;
  private javax.swing.JButton StartSimulation;
  private javax.swing.JTextArea TextSimulation;
  private javax.swing.JButton addCamion;
  private javax.swing.JMenu affichageMenu;
  private javax.swing.JToggleButton ajoutChargeur;
  private javax.swing.JButton ajoutChargeurCoord;
  private javax.swing.JButton ajoutModifChargeur;
  private javax.swing.JToggleButton ajoutNoeud;
  private javax.swing.JButton ajoutNoeudCoord;
  private javax.swing.JButton ajoutNoeudCoordButton;
  private javax.swing.JToggleButton ajoutTas;
  private javax.swing.JButton ajoutTasCoordButton;
  private javax.swing.JTextField angleSpinner;
  private javax.swing.JButton arcButton;
  private javax.swing.JButton boutonChemin;
  private javax.swing.ButtonGroup buttonGroup1;
  private javax.swing.JComboBox<String> comboBoxMateriaux;
  private javax.swing.JButton deleteButton;
  private javax.swing.JButton deleteSimul;
  private javax.swing.JTextField dimensionTas;
  private virtucarriere.gui.DrawingPanel drawingPanel;
  private javax.swing.JMenu editionMenu;
  private javax.swing.JButton entreeButton;
  private javax.swing.JButton fasterSimulation;
  private javax.swing.JMenu fenetreMenu;
  private javax.swing.JMenu fichierMenu;
  private javax.swing.JMenuItem importImage;
  private javax.swing.JMenu importerMenu;
  private javax.swing.JButton jButton1;
  private javax.swing.JButton jButton2;
  private javax.swing.JButton jButton3;
  private javax.swing.JComboBox<String> jComboBox1;
  private javax.swing.JLabel jLabel1;
  private javax.swing.JLabel jLabel10;
  private javax.swing.JLabel jLabel11;
  private javax.swing.JLabel jLabel12;
  private javax.swing.JLabel jLabel13;
  private javax.swing.JLabel jLabel14;
  private javax.swing.JLabel jLabel15;
  private javax.swing.JLabel jLabel16;
  private javax.swing.JLabel jLabel17;
  private javax.swing.JLabel jLabel18;
  private javax.swing.JLabel jLabel19;
  private javax.swing.JLabel jLabel2;
  private javax.swing.JLabel jLabel20;
  private javax.swing.JLabel jLabel21;
  private javax.swing.JLabel jLabel22;
  private javax.swing.JLabel jLabel23;
  private javax.swing.JLabel jLabel24;
  private javax.swing.JLabel jLabel25;
  private javax.swing.JLabel jLabel3;
  private javax.swing.JLabel jLabel4;
  private javax.swing.JLabel jLabel5;
  private javax.swing.JLabel jLabel6;
  private javax.swing.JLabel jLabel7;
  private javax.swing.JLabel jLabel8;
  private javax.swing.JLabel jLabel9;
  private javax.swing.JMenuBar jMenuBar1;
  private javax.swing.JPanel jPanel1;
  private javax.swing.JPanel jPanel2;
  private javax.swing.JPanel jPanel3;
  private javax.swing.JScrollPane jScrollPane1;
  private javax.swing.JScrollPane jScrollPane2;
  private javax.swing.JTabbedPane jTabbedPane;
  private javax.swing.JTextArea jTextArea1;
  private javax.swing.JTextField jTextField2;
  private javax.swing.JPanel mainPanel;
  private javax.swing.JScrollPane mainScrollPane;
  private javax.swing.JComboBox<String> materiauxComboBox;
  private javax.swing.JMenuItem menuAffichageGrille;
  private javax.swing.JMenuItem menuColler;
  private javax.swing.JMenuItem menuCopier;
  private javax.swing.JMenuItem menuCouper;
  private javax.swing.JMenuItem menuNouveauProjet;
  private javax.swing.JMenuItem menuOuvrirProjet;
  private javax.swing.JMenuItem menuQuitter;
  private javax.swing.JMenuItem menuRedo;
  private javax.swing.JMenuItem menuSauvegarderProjet;
  private javax.swing.JMenuItem menuSauvegarderSous;
  private javax.swing.JMenuItem menuUndo;
  private javax.swing.JToggleButton modeSelection;
  private javax.swing.JButton modifierAngle;
  private javax.swing.JButton modifierCamion;
  private javax.swing.JMenuItem modifierGrille;
  private javax.swing.JButton pauseRestartSimulation;
  private javax.swing.JSpinner quantiteSpinner;
  private javax.swing.JMenuItem resetGrille;
  private javax.swing.JMenuItem resetImage;
  private javax.swing.JToggleButton selectionSimul;
  private javax.swing.JButton slowSimulation;
  private javax.swing.JSpinner tempsAttente;
  private javax.swing.JTextField textFieldCoordonneeX;
  private javax.swing.JTextField textFieldCoordonneeY;
  private javax.swing.JTextField xCoordSimul;
  private javax.swing.JTextField yCoordSimul;
  // End of variables declaration//GEN-END:variables
}
